# 抽人

### 目录

## 0 新增内容

## 1 总览

抽人最初的设计目标是在简化抽取过程的同时保证抽取结果的随机性，并在此基础上衍生出状态管理与表扬机制。状态管理可确保抽取过的人不再被抽取；表扬机制便于统计数据，例如投票。

抽人中所处理的基础对象是 学生 ，学生由以下数据构成： 姓名（可重复） 、 表扬次数 、 状态 ，除此之外还包含编号（减少重名导致的错误）与索引信息（便于搜索），但普通用户不可更改（确实有更改索引信息需求的，可在 7.1 底层设计 中了解更多）。

应用整体由以下页面或独立控件构成： 主页 、 详情页 、 文件页 、 设置页 和 搜索 ，其中 搜索 仅在主页和详情页可用。

### 1.1 快速入门

以下是使用应用前应先了解的内容（点击可快速跳转）。导入/快速新建抽标记表扬一下保存导出

## 2 主页

主页是最常使用的页面，也是程序打开时显示的页面，其中包含导入/新建、抽取、调整状态等操作，学生会按照状态分类后显示。

### 2.1 导入/新建数据

以下是使用 导入 或 快速新建 功能所要求的数据格式。

2.1.1 导入

Tips： 导入时，应用会在本地保存一份数据副本并 仅 在此副本中写入数据，若要覆盖数据源，请在修改数据后另存至所需位置。导入成功后，应用会提示并列出全部学生，同时，应用会准备所需内容以便下次启动时可以自动导入该数据。

2.1.1.1 使用 .txt 文件导入（将在后续版本中移除）

使用文本格式导入数据时，源文件 必须 由 UTF 编码，编码格式不正确会导致失败并报错。

Tips： 使用Windows自带的记事本应用可在右下角查看编码格式并在另存时改变编码方式。

单个学生的源数据格式为

姓名（制表符）状态（制表符）表扬次数（制表符）进行次序

其中只有姓名是 必需项 且可包含空格。其余项空白时，表扬次数会自动补为0，状态会补为未完成（unfinished）。

导入时应用会自动删去多余的换行与制表符，因此后项的内容必需时请将前项的内容一并补齐，例如：

1

2.1.1.2 使用 .xlsx 文件导入（推荐）

Tips： .xls 文件不受支持，请先将其转换为 .xlsx 格式后再导入。

使用 .xlsx 文件导入时，文件 不需要也不可有 表头。数据从第一行开始，一行为一个学生，A列为姓名，B列为状态，C列为表扬次数，D列为进行次序（如果该学生状态为进行中（going））。

其中只有姓名是 必需项 且可包含空格。其余项空白时，表扬次数会自动补为0，状态会补为未完成（unfinished）。

2.1.1.3 使用 .json 文件导入（不推荐）

Tips： 本格式仅在需要更改学生索引信息时使用，其基本数据格式如下：

其中所有的项都不可省略，否则会导致失败与报错。

2.1.2 快速新建

快速新建可使用数字快速生成一个新列表，其中所有学生的表扬次数为0，状态为未完成（unfinished）。

快速新建的总数只支持整数且不超过整形（int）的最大值，上、下方向键支持±1的微调，上、下翻页（Page Up/Down）键支持±10的调整。生成时，第一个人名为1，以此类推。

### 2.2 列表

列表分为四页： 全部 、 进行中 、 已完成 与 未完成 ，学生按照其标记的状态分类显示在各个页中并且页头会标注该页含有的总人数，其中，状态为暂停（suspend）的学生不显示在除全部页外的所有页中，因此全部页除外的人数之和可能会不等于全部页的人数。

页中可以在按下Ctrl/Shift键的同时选择间断/连续的多个学生以进行以下操作： 标记为未完成 、 标记为已完成 与 标记为进行中 。由于应用底层问题，在选中多个学生时，标记的顺序会有所改变。状态为暂停（suspend）的学生在被标记后也会改变其状态。

### 2.3 标记

标记为关时，应用将在状态不为暂停（suspend）的学生中抽取；而标记为开时，应用将在状态为未完成（unfinished）的人中抽取，改变抽取到的学生的状态为进行中（going）并分配进行顺序。

### 2.4 表扬一下

表扬会将列表的当前显示页中选择的所有学生的表扬计数+1，随后可在弹出的窗口中撤销，撤销行为也可被再撤销一次。

Tips： 如果没有当前显示页中没有选择学生，表扬也会成功，但所有人的表扬计数均不变化。相关提示将在后续版本中加入。

### 2.5 抽

标记关时，应用将在除状态为暂停（suspend）的剩余学生中随机抽取，且不同的抽取事件之间相互独立。

标记开时，应用将在状态为未完成（unfinished）的学生中随机抽取，且在抽取过程结束时将抽取到学生的状态改为进行中（going）。

动画开启时，应用将在全部学生中抽取另外10人以填充动画，但动画不影响抽取结果。抽取过程结束后，应用会在列表的对应列中选中并显示学生。

### 2.6 保存

保存时，应用将在本地而不是导入时的位置保存，保存成功后，应用将会提示，同时，应用会准备所需内容以便下次启动时可以自动导入该数据。

应用在关闭时也会请求是否保存（无论是否更改过数据内容，此功能将在后续版本中改进）。

### 2.7 另存

另存时，学生将按照导入时的顺序（或者说，详情页中显示的顺序）依次写入用户选择的文件位置。另存后，应用不会在下次启动时导入该数据。

### 2.8 进度指示器

### 2.9 身份指示器

## 3 详情页

详情页按照导入顺序显示每个学生的详细信息，并支持更改信息与新建学生。

选中学生后将会在原学生的基础上更改其信息，且学生在数据集中的位置不变。

新建学生将会在数据集的最后增添信息。

## 4 搜索

搜索支持在主页和详情页内以汉字、全拼与首字母搜索学生姓名并转到详细学生。

### 4.1 在主页中搜索

### 4.2 在详情页中搜索

## 5 文件页

文件页以树形图列出了所有本地存在的数据以及其内部的详细信息。

## 6 设置页

设置页提供了一系列关于应用外观、数据、安全等的设置。

### 6.1 外观

应用可调整的外观有显示模式（深色/浅色），窗口外观（云母/亚克力）与导航栏显示内容（隐藏部分选项卡）。

### 6.2 数据

应用可选择删除已导入的数据集文件，或所有数据。要删除单个数据集文件，请在文件页中操作。

### 6.3 安全

Tips：请注意，除身份文件的密码外，所有应用处理、生成的信息均未经过高安全性加密，甚至明文保存。这个问题部分将在后续版本中改进。

在 导入/保存/导出数据集、更改学生数据或状态（除了使用标记抽取学生）、删除数据集或数据、创建或删除身份文件时，根据设置，应用可能请求验证身份，其安全设置与对应请求的内容如下： 无： 应用不请求验证； 正常： 应用在需要的时候仅请求验证是否存在包含经过认证的可移动存储设备（但创建和删除身份文件仍需要验证密码）； 严格： 应用在需要的时候将始终请求验证密码。

6.3.1 创建身份文件

创建身份文件需要提供非空的用户名与密码，以及一个可移动存储设备。

创建成功后，该可移动设备 仅能在创建文件的本地设备 上完成身份验证。

6.3.2 删除身份文件

可在验证密码后删除身份文件。除此之外，删除应用数据也将删除应用存储的所有身份文件。

### 6. 版本

## 7 高级

高级提供了更加精细的设置指南与有关应用底层逻辑等的内容。

### 7.1 快捷键

### 7.2 底层设计

7.2.1 学生的模型

学生各属性的数据类型为：姓名：字符串型状态：枚举类型，可选值为未完成（unfinished）、已完成（finished）、进行中（going）、暂停（suspend）表扬次数：整型（int）进行顺序：整型（int）编号：整型（int）索引信息：字符串型

7.2.1.1 创建时动作

当学生对象被创建时，该对象会被：按创建顺序分配唯一的编号以减少重名导致的错误并在导出时保持导入时的顺序；在姓名含有汉字的情况下，生成所有可能的全拼与首拼组合，用分号（;）隔开并与姓名组合生成一条索引信息。

7.2.1.2 更改时动作

当学生对象内容被更改时，该对象会被：

在姓名含有汉字的情况下，重新生成索引信息。

7.2.1.3 更改索引信息

7.2.2 搜索逻辑

在搜索框键入文字时，应用将在所有学生的索引中匹配输入，并在建议列表中列出所有的匹配项。

当点击建议项时，主页中：在各状态

详情页中：

7.2.3 异常处理机制

应用运行时产生的关键性异常将会被捕获并再次以弹窗的形式抛出，内容仅供参考。详细的异常报告将会在后续版本中引入。

7.2.4 安全检查机制

7.2.5 文件保存方式

### 7.3 路线图

版本8

*   使用.xlsx文件导入导出

*   删除文件

*   自定义的安全设置

*   完善安全性

*   减少储存占用

*   减少硬编码

版本9

*   使用.json文件导入导出

*   自定义外观与动画

*   Privacy statement

*   快捷键

*   右键更改学生信息

后续版本

*   数据加密保存

*   异常报告

*   可选功能基础

*   无更改不提示保存

*   撤销

*   减少内存占用

*   在小组件中显示进行中的学生

*   拖拽导入

*   调整学生在表中的位置

*   小组件支持

*   日志

*   导入导出用户数据

*   更改/增添学生信息

*   完善进度指示器
